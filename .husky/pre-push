#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

if [ -n "$SKIP_PRE_PUSH" ]; then
  echo "β­οΈ  pre-push push hookμ„ μ¤ν‚µν•©λ‹λ‹¤."
  exit 0
fi

echo "π”¨ λΉλ“ μ‹¤ν–‰ μ¤‘..."
npm run build

if [ $? -ne 0 ]; then
  echo ""
  echo "β λΉλ“ μ‹¤ν¨λ΅ μΈν•΄ pushκ°€ μ¤‘λ‹¨λμ—μµλ‹λ‹¤."
  echo ""
  echo "λ‹¤μ μ‚¬ν•­μ„ ν™•μΈν•΄μ£Όμ„Έμ”:"
  echo "  β€Ά λΉλ“ μ¤λ¥ λ©”μ‹μ§€λ¥Ό ν™•μΈν•μ—¬ λ¬Έμ λ¥Ό ν•΄κ²°ν•΄μ£Όμ„Έμ”"
  echo "  β€Ά TypeScript νƒ€μ… μ¤λ¥κ°€ μλ”μ§€ ν™•μΈν•΄μ£Όμ„Έμ”"
  echo "  β€Ά λ¨λ“  μμ΅΄μ„±μ΄ μ¬λ°”λ¥΄κ² μ„¤μΉλμ—λ”μ§€ ν™•μΈν•΄μ£Όμ„Έμ” (npm install)"
  echo "  β€Ά λ΅μ»¬μ—μ„ 'npm run build'λ¥Ό μ‹¤ν–‰ν•μ—¬ μ¤λ¥λ¥Ό ν™•μΈν•΄μ£Όμ„Έμ”"
  echo ""
  echo "π’¬ λ§μ•½ μλ„μ μΈ pushλΌλ©΄ λ‹¤μ λ…λ Ήμ–΄λ΅ μ¤ν‚µν•  μ μμµλ‹λ‹¤:"
  echo "  SKIP_PRE_PUSH=1 git push"
  echo ""
  echo "λ¬Έμ λ¥Ό ν•΄κ²°ν• ν›„ λ‹¤μ‹ pushλ¥Ό μ‹λ„ν•΄μ£Όμ„Έμ”."
  echo ""
  exit 1
fi

echo "β… λΉλ“ μ„±κ³µ"
